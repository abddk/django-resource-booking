{% extends "index.html" %}
{% load staticfiles %}
{% load booking_tags %}
{% load i18n %}

{% block htmltitle %} - {% trans 'søg i besøg' %}{% endblock %}

{% block content %}
    <div class="row">
        <div id="main" class="col-sm-12 col-md-12">

            {% include 'common/breadcrumbrow.html' %}

            <h1>{% trans 'Søgeresultat' %}</h1>
            <div class="divider"></div>

            <form class="clearfix" role="søg" action={% url 'visit-occ-search' %}>
                <div class="input-group">
                    <label class="sr-only" for="searchBox">{% trans 'Søg efter besøg' %}</label>
                    <input type="text" class="form-control" id="searchBox" placeholder="{% trans 'Søg efter besøg - indtast et eller flere søgeord...' %}" name="q" value="{{ request.GET.q }}"/>
                    <span class="input-group-btn">
                        <a id="reset-btn" class="btn btn-default" aria-label="{% trans 'Ryd søgning' %}">
                            <span class="glyphicon glyphicon-remove"></span>
                        </a>
                        <button class="btn btn-default" id="search" type="submit">
                            <span class="hidden-xs">{% trans 'Søg' %}</span>
                            <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                        </button>
                    </span>
                </div>
            </form>

            <div class="divider"></div>
            <h2>
                {% trans 'Søgningen er begrænset til:' %}
            </h2>
            <ul>
                <li>{{ unit_limit_text }}</li>
            </ul>
            {% if not results %}
            <p>{% trans 'Din søgning gav ikke noget resultat.' %}</p>
            {% else %}
            <h2 class="bold">
                {{ paginator.count }} resultater matcher din søgning
                {% if request.GET.q %}
                på "{{request.GET.q}}"
                {% endif %}
            </h2>
            <div class="divider"></div>
            <ul class="media-list">
            {% for res in results %}
                <li class="media">
                    <div class="media-body">
                        <strong><a href="{% url 'visit-occ-view' res.pk %}">{% trans 'Besøg' %} #{{ res.pk }}</a></strong>
                        <dl class="dl-horizontal">
                            <dt>{% trans 'Tilbud:' %}</dt>
                            <dd><a href="{% url 'visit-view' res.visit.pk %}">#{{ res.visit.pk }} {{ res.visit.title }}</a></dd>
                            <dt>{% trans 'Booket af:' %}</dt>
                            <dd>{% blocktrans with count=res.nr_bookers %} personer{% endblocktrans %}</dd>
                        </dl>
                    </div>
                </li>
               {% endfor %}
            </ul>
            {% endif %}
        </div>
    </div>
    <div class="row">
        <div class="col-sm-6 col-md-5 col-sm-offset-1 col-md-offset-3">
            {% if paginator %}
            <nav>
                <ul class="pagination">

                {% if page_obj.has_previous %}
                <li>
                    <a href="?{{ qstring }}&page={{ page_obj.previous_page_number }}&pagesize={{paginator.per_page}}">
                    <span>
                        <span class="glyphicon glyphicon-chevron-left small" aria-hidden="true"></span>
                        Forrige
                    </span>
                    </a>
                </li>
                {% else %}
                <li class="disabled">
                    <span>
                        <span class="glyphicon glyphicon-chevron-left small" aria-hidden="true"></span>
                        Forrige
                    </span>
                </li>
                {% endif %}
                {% for pnr in paginator.page_range %}
                    {% if page_obj.number == pnr %}
                        <li class="active">
                            <span>{{ pnr }} <span class="sr-only">(aktiv side)</span></span>
                        </li>
                    {% else %}
                        <li><a href="?{{ qstring }}&page={{pnr}}&pagesize={{paginator.per_page}}">{{pnr}}</a></li>
                    {% endif %}
                {% endfor %}
                {% if page_obj.has_next %}
                <li>
                    <a href="?{{ qstring }}&page={{ page_obj.next_page_number }}&pagesize={{paginator.per_page}}" aria-label="Næste">
                    <span>
                        Næste
                        <span class="glyphicon glyphicon-chevron-right small" aria-hidden="true"></span>
                    </span>
                    </a>
                </li>
                {% else %}
                <li class="disabled">
                    <span>
                        Næste
                        <span class="glyphicon glyphicon-chevron-right small" aria-hidden="true"></span>
                    </span>
                </li>
                {% endif %}
            </ul>
            </nav>
            {% endif %}
        </div>
        <div class="col-sm-4 col-md-3">
            <div class="input-group input-group-sm search-list items-pr-side">
                <span class="input-group-addon">Vis</span>
                <div class="input-group-btn">
                    <button type="button" class="btn btn-default">
                        {% if request.GET.pagesize == "all" %}
                            Vis alle
                        {% else %}
                            {{ paginator.per_page }}
                        {% endif %}
                    </button>
                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <span class="caret"></span> <span class="sr-only">Vis anrtal resultater pr. side</span> </button>
                    <ul class="dropdown-menu">
                        <li{% if request.GET.pagesize == "all" %} class="selected"{% endif %}><a href="?{{ qstring }}&pagesize=all">Vis alle</a></li>
                        {% for size in pagesizes %}
                        <li{% if size == paginator.per_page %} class="selected"{% endif %}><a href="?{{ qstring }}&pagesize={{size}}">{{size}}</a></li>
                        {% endfor %}
                    </ul>
                </div>
                <span class="input-group-addon"> pr. side</span>
            </div>
        </div>
    </div>
    
{% endblock %}
{% block footer %}
        <div class="container">
            <div class="row">
                <footer>
                    <div class="container">
                        <div class="row footer-columns">
                            <div class="col-sm-6 col-sm-offset-1 col-md-offset-3">
                                <ul class="footerlinks">
                                    <li><a href="http://kommunikation.ku.dk/">Kommunikation</a></li>
                                    <li><a href="http://www.ku.dk/">Københavns Universitet</a></li>
                                    <li>Nørregade 10, Postboks 2177</li>
                                    <li>1017 København K</li>
                                </ul>
                            </div>
                            <div class="col-sm-3">
                                <ul class="footerlinks">
                                    <li class="clearfix social-icons"><a target="_blank" class="footer-social" href="https://www.facebook.com/universitet"><span class="icon-circle"><i class="fa fa-facebook"></i></span></a><a target="_blank" class="footer-social" href="https://www.linkedin.com/edu/k%C3%B8benhavns-universitet-12012"><span class="icon-circle"><i class="fa fa-linkedin"></i></span></a><a target="_blank" class="footer-social" href="https://twitter.com/koebenhavns_uni"><span class="icon-circle"><i class="fa fa-twitter"></i></span></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </footer>
            </div>
        </div>
    {% endblock %}

{% block extra_scripts %}
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.5.0/js/bootstrap-datepicker.min.js"></script>
    <script src="{% static 'js/bootstrap-datepicker.da.min.js' %}"></script>
    <script src="{% static 'js/custom.js' %}"></script>
    
{% endblock %}
