{% extends "index.html" %}
{% load staticfiles %}
{% load booking_tags %}
{% load i18n %}

{% block htmltitle %} - {% trans 'statistik over evalueringer' %}{% endblock %}

{% block head %}
    {% include 'common/resources/datepicker_style.html' %}
{% endblock %}

{% block content %}

    {% include 'common/breadcrumbrow.html' %}

    <h1>{% trans "Statistik over evalueringer" %}</h1>

    <a id="controlFilter" aria-controls="collapseFilter" aria-expanded="{% if has_filter %}true{% else %}false{% endif %}" href="#collapseFilter" data-parent="#accordion" data-toggle="collapse" role="button">
        {% trans "Filtrér" %}
        <span class="{% if has_filter %}caret-up{% else %}caret{% endif %}"></span>
    </a>
    <div id="collapseFilter" class="panel-collapse collapse {% if has_filter %}in{% endif %}" aria-labelledby="controlFilter" role="tabpanel">
        <form id="evaluationstatisicsform" action="" class="form-horizontal clearfix" method="get">
            <div class="form-group row">
                <div class="col-sm-8 col-sm-offset-2">
                    <label for="{{ form.unit.id_for_label }}">{{ form.unit.label }}</label>
                    {{ form.unit }}
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-4 col-sm-offset-2">
                    <label for="{{ form.from_date.id_for_label }}">{{ form.from_date.label }}</label>
                    {{ form.from_date }}
                </div>
                <div class="col-sm-4">
                    <label for="{{ form.to_date.id_for_label }}">{{ form.to_date.label }}</label>
                    {{ form.to_date }}
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-2 col-sm-offset-8">
                    <button class="btn btn-primary pull-right" type="submit">{% trans 'Opdater' %}</button>
                </div>
            </div>
        </form>
    </div>

    <table class="table table-bordered">
        <thead>
            <tr>
                <th rowspan="2" class="text-center text-top">{% trans 'Tilbud' %}</th>
                <th rowspan="2" class="text-center text-top">{% trans 'Dato' %}</th>
                <th colspan="5" class="text-center">{% trans 'Status' %}</th>
            </tr>
            <tr>
                <th class="text-center">{% trans 'Ikke deltagende' %}</th>
                <th class="text-center">{% trans 'Ikke afholdt' %}</th>
                <th class="text-center">{% trans 'Sendt første gang' %}</th>
                <th class="text-center">{% trans 'Sendt anden gang' %}</th>
                <th class="text-center">{% trans 'Har klikket på link' %}</th>
            </tr>
        </thead>
        <tbody>
            {% for visit in visits %}
                <tr>
                    <td>
                        {% if visit.is_multiproductvisit %}
                        {{ visit.display_title }}
                        {% else %}
                        <a href="{% url 'product-view' visit.product.id %}">{{ visit.display_title }}</a>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{% url 'visit-view' visit.id %}">{{ visit.date_display }}</a>
                    </td>
                    <td>{{ visit.evaluation_no_participation.count }}</td>
                    <td>{{ visit.evaluation_not_sent.count }}</td>
                    <td>{{ visit.evaluation_first_sent.count }}</td>
                    <td>{{ visit.evaluation_second_sent.count }}</td>
                    <td>{{ visit.evaluation_link_clicked.count }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

{% endblock %}

{% block extra_scripts %}
{% include 'common/resources/datepicker_script.html' %}
<script type="text/javascript"><!--
jQuery(function($) {
    $('#id_from_date').datepicker('setStartDate', null);
});
//--></script>
{% endblock %}
